{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "GeoView Core Config Schema",
  "type": "object",
  "version": 1.0,
  "comments": "Configuration for GeoView core packages, each packages manages it own schema. It correspond to the TypeMapFeaturesConfig type defined in the GeoView typescript code.",
  "additionalProperties": false,

  "definitions": {
    "TypeDetailsLayerConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "additionalProperties": false,
        "parser": {
          "type": "string",
          "description": "A path to a javascript file with a function for parsing the layers identify output. Only needed if a custom template is being used."
        },
        "template": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "description": "A path to an html template (English) that will override default identify output."
            },
            "fr": {
              "type": "string",
              "description": "A path to an html template (French) that will override default identify output."
            }
          },
          "required": [
            "en",
            "fr"
          ]
        }
      },
      "required": ["template"]
    },

    "featureInfoLayerConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "queryable": {
          "type": "boolean",
          "default": true,
          "description": "Allow querying. Default = true."
        },
        "customParser": { "$ref": "#/definitions/TypeDetailsLayerConfig" },
        "nameField": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "description": "The display field (English) of the layer. If it is not present the viewer will make an attempt to find the first valid field."
            },
            "fr": {
              "type": "string",
              "description": "The display field (French) of the layer. If it is not present the viewer will make an attempt to find the first valid field."
            }
          },
          "required": [
            "en",
            "fr"
          ]
        },
        "tooltipField": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "description": "The field (English) to be used for tooltips. If it is not present the viewer will use nameField (if provided)."
            },
            "fr": {
              "type": "string",
              "description": "The field (French) to be used for tooltips. If it is not present the viewer will use nameField (if provided)."
            }
          },
          "required": [
            "en",
            "fr"
          ]
        },
        "outfields": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "default": "*",
              "description": "A comma separated list of attribute names (English) that should be requested on query (all by default)."
            },
            "fr": {
              "type": "string",
              "default": "*",
              "description": "A comma separated list of attribute names (French) that should be requested on query (all by default)."
            }
          }
        },
        "aliasFields": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "default": "",
              "description": "A comma separated list of attribute names (English) that should be use for alias. If empty, no alias will be set if not found."
            },
            "fr": {
              "type": "string",
              "default": "",
              "description": "A comma separated list of attribute names (French) that should be use for alias. If empty, no alias will be set if not found."
            }
          },
          "required": [
            "en",
            "fr"
          ]
        }
      }
    },

    "TypeFillSymbolConfig": {
      "additionalProperties": false,
      "type": "object",
      "description": "Fill style for vector features.",
      "properties": {
        "color": {
          "additionalProperties": false,
          "type": "string"
        }
      },
      "required": ["color"]
    },

    "TypeStrokeSymbolConfig": {
      "additionalProperties": false,
      "type": "object",
      "description": "Stroke style for vector features.",
      "properties": {
        "color": {
          "type": "string"
        },
        "width": {
          "type": "number"
        }
      },
      "required": ["color", "width"]
    },

    "TypeSimpleSymbolVectorConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "fill": { "$ref": "#/definitions/TypeFillSymbolConfig" },
        "stroke": { "$ref": "#/definitions/TypeStrokeSymbolConfig" },
        "radius": { "type": "number" }
      }
    },

    "TypeCircleSymbolVectorConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "fill": { "$ref": "#/definitions/TypeFillSymbolConfig" },
        "stroke": { "$ref": "#/definitions/TypeStrokeSymbolConfig" },
        "radius": { "type": "number" }
      },
      "required": ["radius"]
    },

    "TypeIconSymbolVectorConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "src": { "type": "string" },
        "size": {
          "type": "integer",
          "description": "Icon size in pixel."
        },
        "opacity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 1
        },
        "crossOrigin": {
          "type": "string",
          "description": "The crossOrigin attribute for loaded images. Note that you must provide a crossOrigin value if you want to access pixel data with the Canvas renderer."
        }
      }
    },

    "simpleStyleConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "styleType": {
          "enum": ["simple"]
        },
        "label": {
          "type": "string"
        },
        "options": {
          "anyOf": [
            { "$ref": "#/definitions/TypeSimpleSymbolVectorConfig" },
            { "$ref": "#/definitions/TypeCircleSymbolVectorConfig" },
            { "$ref": "#/definitions/TypeIconSymbolVectorConfig" }
          ]
        }
      },
      "required": ["styleType", "label", "options"]
    },

    "uniqueValueStyleConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "styleType": {
          "enum": ["uniqueValue"]
        },
        "label": {
          "type": "string"
        },
        "fields": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "uniqueValueStyleInfo": {
          "type": "array",
          "items": {
            "additionalProperties": false,
            "label": {
              "type": "string"
            },
            "values": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "minItems": 1
            },
            "options": {
              "anyOf": [
                { "$ref": "#/definitions/TypeSimpleSymbolVectorConfig" },
                { "$ref": "#/definitions/TypeCircleSymbolVectorConfig" },
                { "$ref": "#/definitions/TypeIconSymbolVectorConfig" }
              ]
            }
          },
          "minItems": 2,
          "required": ["label", "values", "options"]
        }
      },
      "required": ["styleType", "label", "fields", "uniqueValueStyleInfo"]
    },

    "classBreakStyleConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "id": {
          "type": "string"
        },
        "styleType": {
          "enum": ["classBreak"]
        },
        "label": {
          "type": "string"
        },
        "field": {
          "type": "string"
        },
        "classBreakStyleInfo": {
          "additionalProperties": false,
          "type": "array",
          "items": {
            "additionalProperties": false,
            "label": {
              "type": "string"
            },
            "minValues": {
              "type": "number"
            },
            "maxValues": {
              "type": "number"
            },
            "options": {
              "anyOf": [
                { "$ref": "#/definitions/TypeSimpleSymbolVectorConfig" },
                { "$ref": "#/definitions/TypeCircleSymbolVectorConfig" },
                { "$ref": "#/definitions/TypeIconSymbolVectorConfig" }
              ]
            }
          },
          "minItems": 2,
          "required": ["label", "minValue", "maxValue", "options"]
        }
      },
      "required": ["styleType", "label", "field", "classBreakStyleInfo"]
    },

    "styleConfig": {
      "anyOf": [
        { "$ref": "#/definitions/simpleStyleConfig" },
        { "$ref": "#/definitions/uniqueValueStyleConfig" },
        { "$ref": "#/definitions/classBreakStyleConfig" }
      ]
    },

    "layerBasicInfoConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "layerId": {
          "type": "string",
          "description": "The id of the layer to display on the map."
        },
        "layerName": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "description": "The display name of the layer (English). If it is not present the viewer will make an attempt to scrape this information."
            },
            "fr": {
              "type": "string",
              "description": "The display name of the layer (French). If it is not present the viewer will make an attempt to scrape this information."
            }
          }
        },
        "metadataUrl": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "default": null,
              "description": "The metadata url of the layer service (English)."
            },
            "fr": {
              "type": "string",
              "default": null,
              "description": "The metadata url of the layer service (French)."
            }
          },
          "required": [
            "en",
            "fr"
          ]
        }
      },
      "required": ["layerId"]
    },

    "layerInitialConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "opacity": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "default": 1,
          "description": "Initial opacity setting."
        },
        "visible": {
          "type": "boolean",
          "default": true,
          "description": "Initial visibility setting."
        },
        "extent": {
          "type": "array",
          "minItems": 4,
          "maxItems": 4,
          "items": {
            "type": "number"
          },
          "description": "The extent that constrains the view. Called with [minX, minY, maxX, maxY] extent coordinates."
        },
        "minZoom": {
          "type": "integer",
          "minimum": 0,
          "maximum": 50,
          "description": "The minimum view zoom level (exclusive) above which this layer will be visible."
        },
        "maxZoom": {
          "type": "integer",
          "minimum": 0,
          "maximum": 50,
          "description": "The maximum view zoom level (inclusive) above which this layer will be visible."
        },
        "className": {
          "type": "string",
          "description": "A CSS class name to set to the layer element."
        }
      }
    },

    "sourceAccessPathConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "en": {
          "type": "string",
          "description": "The service endpoint of the layer (English). It should match the type provided in layerType."
        },
        "fr": {
          "type": "string",
          "description": "The service endpoint of the layer (French). It should match the type provided in layerType."
        }
      },
      "required": [
        "en",
        "fr"
      ]
    },

    "vectorSourceInitialConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "accessPath": { "$ref": "#/definitions/sourceAccessPathConfig" },
        "format": {
          "enum": ["GeoJSON", "EsriJSON", "KML", "WFS", "featureAPI"],
          "description": "The feature format used by the XHR feature loader when access path is set."
        },
        "featureInfo": { "$ref": "#/definitions/featureInfoLayerConfig" },
        "cluster": {
          "additionalProperties": false,
          "type": "object",
          "description": "Cluster vector data on vector layer. Works out of the box with point geometries. If another geometry is provided, it will be converted to points geometry.",
          "properties": {
            "enable": {
              "type": "boolean",
              "default": false
            },
            "distance": {
              "type": "integer",
              "description": "Distance in pixels within which features will be clustered together (deafult 20px)."
            },
            "minDistance": {
              "type": "integer",
              "description": "Minimum distance in pixels between clusters. Will be capped at the configured distance. By default no minimum distance is guaranteed. This config can be used to avoid overlapping icons. As a tradoff, the cluster feature's position will no longer be the center of all its features."
            }
          }
        }
      },
      "required": ["accessPath", "format"]
    },

    "sourceImageInitialConfig": {
      "anyOf": [
        { "$ref": "#/definitions/sourceImageWmsInitialConfig" },
        { "$ref": "#/definitions/sourceImageEsriInitialConfig" }
      ]
    },

    "sourceImageWmsInitialConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "accessPath": {
          "$ref": "#/definitions/sourceAccessPathConfig"
        },
        "crossOrigin": {
          "type": "string",
          "description": "The crossOrigin attribute for loaded images. Note that you must provide a crossOrigin value if you want to access pixel data with the Canvas renderer."
        },
        "projection": {
          "type": "integer",
          "description": "Spatial Reference EPSG code supported (https://epsg.io/). We support Web Mercator and Lambert Conical Conform Canada."
        },
        "featureInfo": {
          "$ref": "#/definitions/featureInfoLayerConfig"
        },
        "serverType": {
          "enum": ["mapserver", "geoserver", "qgis"],
          "description": "The type of the remote WMS server. Not needed for type ESRI"
        },
        "style": {
          "type": "string",
          "default": "",
          "description": "Style to apply"
        }
      },
      "required": ["accessPath", "serverType"]
    },

    "sourceImageEsriInitialConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "accessPath": {
          "$ref": "#/definitions/sourceAccessPathConfig"
        },
        "crossOrigin": {
          "type": "string",
          "description": "The crossOrigin attribute for loaded images. Note that you must provide a crossOrigin value if you want to access pixel data with the Canvas renderer."
        },
        "projection": {
          "type": "integer",
          "description": "Spatial Reference EPSG code supported (https://epsg.io/). We support Web Mercator and Lambert Conical Conform Canada."
        },
        "featureInfo": {
          "$ref": "#/definitions/featureInfoLayerConfig"
        },
        "format": {
          "enum": ["png", "jpg", "gif", "svg"],
          "default": "png",
          "description": "The format of the exported image. The default format is png."
        },
        "transparent": {
          "type": "boolean",
          "default": true,
          "description": "If true, the image will be exported with the background color of the map set as its transparent color. Only the .png and .gif formats support transparency."
        }
      },
      "required": ["accessPath"]
    },

    "sourceTileInitialConfig": {
      "additionalProperties": false,
      "properties": {
        "accessPath": { "$ref": "#/definitions/sourceAccessPathConfig" },
        "crossOrigin": {
          "type": "string",
          "description": "The crossOrigin attribute for loaded images. Note that you must provide a crossOrigin value if you want to access pixel data with the Canvas renderer."
        },
        "projection": {
          "type": "integer",
          "description": "Spatial Reference EPSG code supported (https://epsg.io/). We support Web Mercator and Lambert Conical Conform Canada."
        },
        "tileGrid": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "extent": {
              "type": "array",
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                },
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "description": "The extent that constrains the view. Called with [minX, minY, maxX, maxY] extent coordinates."
            },
            "origin": {
              "type": "array",
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "description": "The tile grid origin, i.e. where the x and y axes meet ([z, 0, 0]). Tile coordinates increase left to right and downwards. If not specified, extent must be provided."
            },
            "resolutions": {
              "type": "array",
              "items": {
                "type": "number"
              },
              "description": "Resolutions. The array index of each resolution needs to match the zoom level. This means that even if a minZoom is configured, the resolutions array will have a length of maxZoom + 1."
            },
            "tileSize": {
              "type": "array",
              "prefixItems": [
                {
                  "type": "number"
                },
                {
                  "type": "number"
                }
              ],
              "default": [256, 256],
              "description": "The tile grid origin, i.e. where the x and y axes meet ([z, 0, 0]). Tile coordinates increase left to right and downwards. If not specified, extent must be provided."
            }
          },
          "required": ["origin", "resolutions"]
        }
      },
      "required": ["accessPath"]
    },

    "vectorHeatmapLayerEntryConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "info": { "$ref": "#/definitions/layerBasicInfoConfig" },
        "initialSettings": { "$ref": "#/definitions/layerInitialConfig" },
        "source": { "$ref": "#/definitions/vectorSourceInitialConfig" },
        "gradient": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "uniqueItems": true,
          "minItems": 2,
          "default": ["#00f", "#0ff", "#0f0", "#ff0", "#f00"],
          "description": "Color gradient of the heatmap, specified as an array of CSS color strings."
        },
        "radius": {
          "type": "number",
          "description": "Radius size in pixels (default 8px)."
        },
        "blur": {
          "type": "number",
          "description": "Blur size in pixels (default 15px)."
        },
        "weight": {
          "type": "string",
          "description": "Feature attribute to use for the weight or a function (ADD FORMAT) that returns a weight from a feature."
        }
      },
      "required": ["source"]
    },

    "vectorLayerEntryConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "info": { "$ref": "#/definitions/layerBasicInfoConfig" },
        "initialSettings": { "$ref": "#/definitions/layerInitialConfig" },
        "source": { "$ref": "#/definitions/vectorSourceInitialConfig" },
        "style": { "$ref": "#/definitions/styleConfig" }
      },
      "required": ["source"]
    },

    "vectorTileLayerEntryConfig": {
      "additionalProperties": false,
      "type": "object",
      "description": "Layer sources providing vector data divided into a tile grid.",
      "properties": {
        "info": { "$ref": "#/definitions/layerBasicInfoConfig" },
        "initialSettings": { "$ref": "#/definitions/layerInitialConfig" },
        "source": {
          "additionalProperties": false,
          "type": "object",
          "description": "Layer sources providing vector data divided into a tile grid.",
          "properties": {
            "accessPath": { "$ref": "#/definitions/sourceAccessPathConfig" },
            "format": {
              "enum": ["GeoJSON", "EsriJSON", "KML", "WFS", "MVT", "featureAPI"],
              "description": "The feature format used by the XHR feature loader when access path is set."
            },
            "featureInfo": { "$ref": "#/definitions/featureInfoLayerConfig" },
            "style": { "$ref": "#/definitions/styleConfig" },
            "projection": {
              "type": "integer",
              "description": "Spatial Reference EPSG code supported (https://epsg.io/). We support Web Mercator and Lambert Conical Conform Canada."
            },
            "tileGrid": {
              "additionalProperties": false,
              "type": "object",
              "properties": {
                "extent": {
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "number"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "number"
                    }
                  ],
                  "description": "The extent that constrains the view. Called with [minX, minY, maxX, maxY] extent coordinates."
                },
                "origin": {
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "number"
                    },
                    {
                      "type": "number"
                    }
                  ],
                  "description": "The tile grid origin, i.e. where the x and y axes meet ([z, 0, 0]). Tile coordinates increase left to right and downwards. If not specified, extent must be provided."
                },
                "resolutions": {
                  "type": "array",
                  "items": {
                    "type": "number"
                  },
                  "description": "Resolutions. The array index of each resolution needs to match the zoom level. This means that even if a minZoom is configured, the resolutions array will have a length of maxZoom + 1."
                },
                "tileSize": {
                  "type": "array",
                  "prefixItems": [
                    {
                      "type": "number"
                    },
                    {
                      "type": "number"
                    }
                  ],
                  "default": [256, 256],
                  "description": "The tile grid origin, i.e. where the x and y axes meet ([z, 0, 0]). Tile coordinates increase left to right and downwards. If not specified, extent must be provided."
                }
              },
              "required": ["origin", "resolutions"]
            }
          },
          "required": ["accessPath"]
        }
      },
      "required": ["source"]
    },

    "imageLayerEntryConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "info": { "$ref": "#/definitions/layerBasicInfoConfig" },
        "initialSettings": { "$ref": "#/definitions/layerInitialConfig" },
        "source": { "$ref": "#/definitions/sourceImageInitialConfig" }
      },
      "required": ["source"]
    },

    "tileLayerEntryConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "info": { "$ref": "#/definitions/layerBasicInfoConfig" },
        "initialSettings": { "$ref": "#/definitions/layerInitialConfig" },
        "source": { "$ref": "#/definitions/sourceTileInitialConfig" }
      },
      "required": ["source"]
    },

    "geoCoreLayerEntryConfig": {
      "additionalProperties": false,
      "type": "object",
      "description": "Layer where configration is extracted by a configuration snippet stored on a server. The server configuration will handle bilangual informations.",
      "properties": {
        "info": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "layerId": {
              "type": "string",
              "description": "The id of the layer to display on the map."
            },
            "layerName": {
              "additionalProperties": false,
              "type": "object",
              "properties": {
                "en": {
                  "type": "string",
                  "description": "The display name of the layer (English). If it is not present the viewer will make an attempt to scrape this information."
                },
                "fr": {
                  "type": "string",
                  "description": "The display name of the layer (French). If it is not present the viewer will make an attempt to scrape this information."
                }
              },
              "required": [
                "en",
                "fr"
              ]
            }
          },
          "required": ["layerId"]
        },
        "accessPath": {
          "type": "string",
          "description": "The url path to the geoCore endpoint (optional, this value should be embeded in the GeoView API)."
        }
      },
      "required": ["info"]
    },

    "layerEntryConfig": {
      "anyOf": [
        { "$ref": "#/definitions/vectorHeatmapLayerEntryConfig" },
        { "$ref": "#/definitions/vectorTileLayerEntryConfig" },
        { "$ref": "#/definitions/vectorLayerEntryConfig" },
        { "$ref": "#/definitions/imageLayerEntryConfig" },
        { "$ref": "#/definitions/tileLayerEntryConfig" },
        { "$ref": "#/definitions/geoCoreLayerEntryConfig" }
      ]
    },

    "listOfLayerEntryConfig": {
      "type": "array",
      "minItems": 1,
      "additionalProperties": false,
      "items": {
        "$ref": "#/definitions/layerEntryConfig"
      }
    },

    "TypeMapConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "basemapOptions": { "$ref": "#/definitions/TypeBasemapOptions" },
        "interaction": { "$ref": "#/definitions/TypeInteraction" },
        "listOfGeoviewLayerConfig": { "$ref": "#/definitions/TypeListOfGeoviewLayerConfig" },
        "viewSettings": { "$ref": "#/definitions/TypeViewSettings" },
        "extraOptions": {
          "type": "object",
          "description": "Additional options used for OpenLayers map options"
        }
      },
      "required": ["basemapOptions", "interaction", "viewSettings"]
    },

    "TypeBasemapOptions": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "id": { "$ref": "#/definitions/TypeBasemapId" },
        "shaded": {
          "type": "boolean",
          "default": true,
          "description": "Enable or disable shaded basemap (if basemap id is set to shaded then this should be false)."
        },
        "labeled": {
          "type": "boolean",
          "default": true,
          "description": "Enable or disable basemap labels"
        }
      },
      "required": ["id", "shaded", "labeled"]
    },

    "TypeBasemapId": {
      "enum": ["transport", "osm", "simple", "nogeom", "shaded"],
      "default": "transport",
      "description": "Id of the basemap to use."
    },

    "TypeInteraction": {
      "enum": ["static", "dynamic"],
      "default": "dynamic",
      "description": "If map is dynamic (pan/zoom) or static to act as a thumbnail (no nav bar)."
    },

    "TypeListOfGeoviewLayerConfig": {
      "description": "List of GeoView Layers in the order which they should be added to the map.",
      "type": "array",
      "additionalProperties": false,
      "items": {
        "$ref": "#/definitions/TypeGeoviewLayerConfig"
      }
    },

    "TypeGeoviewLayerConfig": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "The id of the layer for referencing within the viewer (does not relate directly to any external service). The id will have the language extension (id-'lang')."
        },
        "name": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "description": "The display name of the layer (English). If it is not present the viewer will make an attempt to scrape this information."
            },
            "fr": {
              "type": "string",
              "description": "The display name of the layer (French). If it is not present the viewer will make an attempt to scrape this information."
            }
          }
        },
        "accessPath": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string",
              "default": null,
              "description": "The GeoView layer access path (English)."
            },
            "fr": {
              "type": "string",
              "default": null,
              "description": "The GeoView layer access path (French)."
            }
          },
          "required": [
            "en",
            "fr"
          ]
        },
        "geoviewLayerType": {
          "type": "string",
          "items": {
            "enum": [
              "esriDynamic",
              "esriFeature",
              "geojson",
              "geoCore",
              "xyzTiles",
              "ogcFeature",
              "ogcWfs",
              "ogcWms"
            ]
          },
          "description": "Type of GeoView layer."
        },
        "listOfLayerEntryConfig": {
          "$ref": "#/definitions/listOfLayerEntryConfig",
          "description": "The layer entries to use from the GeoView layer."
        }
      },
      "required": [
        "id",
        "geoviewLayerType",
        "listOfLayerEntryConfig"
      ]
    },

    "TypeViewSettings": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "center": {
          "type": "array",
          "prefixItems": [
            {
              "type": "number",
              "minimum": -160,
              "maximum": 160,
              "default": -106,
              "description": "Initial longitude value for map center."
            },
            {
              "type": "number",
              "minimum": -80,
              "maximum": 80,
              "default": 60,
              "description": "Initial latitude value for map center."
            }
          ],
          "default": [-106, 60]
        },
        "enableRotation": {
          "type": "boolean",
          "default": true,
          "description": "Enable rotation. If false, a rotation constraint that always sets the rotation to zero is used."
        },
        "extent": {
          "type": "array",
          "prefixItems": [
            {
              "type": "number"
            },
            {
              "type": "number"
            },
            {
              "type": "number"
            },
            {
              "type": "number"
            }
          ],
          "description": "The extent that constrains the view. Called with [minX, minY, maxX, maxY] extent coordinates."
        },
        "minZoom": {
          "type": "integer",
          "description": "The minimum zoom level used to determine the resolution constraint. If not set, will use default from basemap.",
          "minimum": 0,
          "maximum": 50
        },
        "maxZoom": {
          "type": "integer",
          "description": "The maximum zoom level used to determine the resolution constraint. If not set, will use default from basemap.",
          "minimum": 0,
          "maximum": 50
        },
        "projection": { "$ref": "#/definitions/TypeProjectionCodes" },
        "rotation": {
          "type": "integer",
          "minimum": -360,
          "maximum": 360,
          "default": 0,
          "description": "The initial rotation for the view in degree (positive rotation clockwise, 0 means North). Will be converted to radiant by the viewer."
        },
        "zoom": {
          "type": "integer",
          "minimum": 0,
          "maximum": 28,
          "default": 12,
          "description": "Initial map zoom level. Zoom level are define by the basemap zoom levels."
        }
      },
      "required": ["zoom", "center"]
    },

    "TypeProjectionCodes": {
      "enum": [3978, 3857],
      "default": 3978,
      "description": "Spatial Reference EPSG code supported (https://epsg.io/). We support Web Mercator and Lambert Conical Conform Canada."
    },

    "TypeAppBarProps": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "about": {
          "additionalProperties": false,
          "type": "object",
          "properties": {
            "en": {
              "type": "string"
            },
            "fr": {
              "type": "string"
            }
          },
          "required": [
            "en",
            "fr"
          ],
          "description": "The content of the about section in Markdown format. If empty, it will be ignored. If not, it will create a button on the appbar to open the panel. In the basic view, this information may be added in a container above the map."
        }
      }
    },

    "TypeNavBarProps": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "enum": ["zoom", "fullscreen", "fullextent"]
      },
      "default": ["zoom", "fullscreen", "fullextent"],
      "description": "Controls availalbe on the navigation bar.",
      "minItems": 0
    },

    "TypeMapComponents": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "enum": ["appbar", "navbar", "overview-map", "north-arrow"]
      },
      "default": ["appbar", "navbar", "overview-map", "north-arrow"],
      "description": "Core components to initialize on viewer load. The schema for those are inside this file.",
      "minItems": 0
    },

    "TypeMapCorePackages": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "enum": ["basemap-panel", "layers-panel", "details-panel", "geolocator-panel"]
      },
      "default": ["basemap-panel", "layers-panel", "details-panel", "geolocator-panel"],
      "description": "Core packages to initialize on viewer load. The schema for those are on their own package. NOTE: config from packages are in the same loaction as core config (<<core config name>>-<<package name>>.json).",
      "minItems": 0
    },

    "TypeExternalPackages": {
      "type": "array",
      "items": {
        "additionalProperties": false,
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "description": "External Package name. The name must be ideintical to the window external package object to load."
          },
          "configUrl": {
            "type": "string",
            "description": "The url to the external package configuration setting. The core package will read the configuration and pass it inside the package."
          }
        },
        "required": ["name"]
      },
      "default": [],
      "description": "List of external packages to initialize on viewer load.",
      "minItems": 0
    },

    "TypeServiceUrls": {
      "additionalProperties": false,
      "type": "object",
      "description": "Service endpoint urls",
      "properties": {
        "keys": {
          "type": "string",
          "default": "https://geocore.api.geo.ca",
          "description": "Service end point to access API for layers specification (loading and plugins parameters). By default it is GeoCore but can be another endpoint with similar output."
        },
        "proxyUrl": {
          "type": "string",
          "description": "An optional proxy to be used for dealing with same-origin issues.  URL must either be a relative path on the same server or an absolute path on a server which sets CORS headers."
        }
      }
    },

    "TypeLocalizedLanguages": {
      "enum": ["en-CA", "fr-CA"],
      "description": "ISO 639-1 code indicating the languages supported by the configuration file."
    },

    "TypeListOfLocalizedLanguages": {
      "type": "array",
      "uniqueItems": true,
      "items": { "$ref": "#/definitions/TypeLocalizedLanguages" },
      "default": ["en-CA", "fr-CA"],
      "description": "ISO 639-1 code indicating the languages supported by the configuration file. It will use value(s) provided here to access bilangual configuration nodes. For value(s) provided here, each bilingual configuration node MUST provide a value.",
      "minItems": 1
    },

    "TypeValidVersions": {
      "enum": ["1.0"],
      "description": "The schema version that can be used to validate the configuration file. The schema should enumerate the list of versions accepted by this version of the viewer."
    }
  },

  "properties": {
    "additionalProperties": false,
    "map": { "$ref": "#/definitions/TypeMapConfig" },
    "theme": {
      "enum": ["dark", "light"],
      "default": "dark",
      "description": "Theme style the viewer."
    },
    "appBar": { "$ref": "#/definitions/TypeAppBarProps" },
    "navBar": { "$ref": "#/definitions/TypeNavBarProps" },
    "components": { "$ref": "#/definitions/TypeMapComponents" },
    "corePackages": { "$ref": "#/definitions/TypeMapCorePackages" },
    "externalPackages": { "$ref": "#/definitions/TypeServiceUrls" },
    "serviceUrls": { "$ref": "#/definitions/TypeServiceUrls" },
    "suportedLanguages": { "$ref": "#/definitions/TypeListOfLocalizedLanguages" },
    "versionUsed": { "$ref": "#/definitions/TypeValidVersions" }
  },
  "required": ["map", "suportedLanguages"]
}
